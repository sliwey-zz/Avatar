!function(e,t,i){"use strict";function a(){n();for(var e in E)E.hasOwnProperty(e)&&(E[e]=!1);g.classList.remove(w),f.classList.remove(w),u.classList.remove(w)}function n(){d&&(y.putImageData(d,0,0),l=s(d))}function r(){n();for(var e in E)E.hasOwnProperty(e)&&E[e]&&v[e]()}function s(e){for(var t=y.createImageData(e.width,e.height),i=e.data,a=t.data,n=0;n<i.length;n++)a[n]=i[n];return t}function c(e){var i=new Image;i.src=t.URL.createObjectURL(e),i.onload=function(){y.drawImage(i,0,0,200,200),o.style.visibility="hidden",m.style.visibility="visible",p=!0,d=y.getImageData(0,0,m.width,m.height),l=s(d),t.URL.revokeObjectURL(e)}}var d,l,v,o=e.getElementById("target"),h=e.getElementById("file"),g=e.getElementById("pixelate"),f=e.getElementById("inverse"),u=e.getElementById("gray"),L=e.getElementById("init"),m=e.getElementById("canvas"),y=m.getContext("2d"),p=!1,E={pixelate:!1,inverse:!1,gray:!1},w="select";v={pixelate:function(){var e,t,i,a,n,r,s,c,d=l.data,v=20,o=20,h=l.width/o,g=l.height/v;for(y.clearRect(0,0,m.width,m.height),e=0;v>e;e++)for(t=0;o>t;t++)i=~~(h*t+h/2),a=~~(g*e+g/2),n=4*i+~~(a*l.width*4),r=d[n],s=d[n+1],c=d[n+2],y.fillStyle="rgb("+r+","+s+","+c+")",y.fillRect(h*t,g*e,h,g);l=y.getImageData(0,0,m.width,m.height)},inverse:function(){var e=l.data,t=l.width*l.height;y.clearRect(0,0,m.width,m.height);for(var i=0;t>i;i++)e[4*i]=255-e[4*i],e[4*i+1]=255-e[4*i+1],e[4*i+2]=255-e[4*i+2];y.putImageData(l,0,0)},gray:function(){var e,t=l.data,i=l.width*l.height;y.clearRect(0,0,m.width,m.height);for(var a=0;i>a;a++)e=~~((t[4*a]+t[4*a+1]+t[4*a+2])/3),t[4*a]=e,t[4*a+1]=e,t[4*a+2]=e;y.putImageData(l,0,0)}},o.addEventListener("click",function(){h.click()},!1),o.addEventListener("dragenter",function(e){var t=e.dataTransfer.types;t=Array.prototype.slice.call(t),-1!==t.indexOf("Files")&&this.classList.add("active")},!1),o.addEventListener("dragover",function(e){e.preventDefault()},!1),o.addEventListener("dragleave",function(e){this.classList.remove("active")},!1),o.addEventListener("drop",function(e){var t=e.dataTransfer.files[0];c(t),e.preventDefault()},!1),h.addEventListener("change",function(){var e=this.files[0];c(e)},!1),g.addEventListener("click",function(){p&&(E.pixelate=!E.pixelate,E.pixelate?this.classList.add(w):this.classList.remove(w),r())},!1),f.addEventListener("click",function(){p&&(E.inverse=!E.inverse,E.inverse?this.classList.add(w):this.classList.remove(w),r())},!1),u.addEventListener("click",function(){p&&(E.gray=!E.gray,E.gray?this.classList.add(w):this.classList.remove(w),r())},!1),L.addEventListener("click",function(){a()},!1)}(document,window);